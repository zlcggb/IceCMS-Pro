(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/post/video-detail"],{"33f8":function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var e={data:function(){return{postDetail:{content:"",media:[],userInfo:{username:""}},isSubmitD:!1,commentPopup:!1,commentList:[],focus:!1,placeholder:"说点什么...",page:1,form:{pid:0,type:1,to_uid:"",post_id:"",content:""},loadStatus:"loadmore"}},filters:{replace:function(t){return t=t.replace(/\n/g,""),t.length>20&&(t=t.substring(0,20)+"..."),t}},computed:{timestamp:function(){return Date.parse(new Date)/1e3}},onLoad:function(t){this.postId=t.id,t.scene&&(this.postId=t.scene),this.form.post_id=this.postId,this.getPostDetail(),this.getCommentList()},methods:{appShare:function(o){var e=e=this.postDetail.media[0],i=this,n=getCurrentPages();n[n.length-1].$page.fullPath;t.share({provider:"weixin",scene:o,type:0,href:"http://xy.tujingzg.com/api/post/detail?id="+i.postId,summary:i.postDetail.content,title:i.postDetail.content,imageUrl:e,success:function(o){t.showToast({title:"分享成功",icon:"none",duration:2e3}),i.posters=!1},fail:function(o){t.showToast({title:"分享失败",icon:"none",duration:2e3}),i.posters=!1}})},delComment:function(o,e,i){var n=this,s=t.getStorageSync("userInfo");o.uid==s.uid&&t.showModal({title:"提示",content:"确定删除该评论？",success:function(t){t.confirm?n.$H.post("comment/del",{id:o.id}).then((function(t){200==t.code&&(i||0===i?n.commentList[e].children.splice(i,1):n.commentList.splice(e,1))})):t.cancel}})},onCopy:function(){var o=this;t.setClipboardData({data:this.postDetail.content,success:function(){t.hideToast(),o.$q.toast("复制成功","success")}})},reachBottom:function(){this.page++,this.getCommentList()},jumpUser:function(o){t.navigateTo({url:"/pages/user/home?uid="+o})},onThumbs:function(t,o,e){var i=this;this.$H.post("comment/thumbs",{id:t}).then((function(t){200==t.code&&(e||0==e?(i.commentList[o].children[e].is_thumbs=!0,i.commentList[o].children[e].thumbs++):(i.commentList[o].is_thumbs=!0,i.commentList[o].thumbs++))}))},cancelThumbs:function(t,o,e){var i=this;console.log(o+","+e),this.$H.post("comment/cancelThumbs",{id:t}).then((function(t){200==t.code&&(e||0==e?(i.commentList[o].children[e].is_thumbs=!1,i.commentList[o].children[e].thumbs--):(i.commentList[o].is_thumbs=!1,i.commentList[o].thumbs--))}))},onReply:function(t){this.placeholder="回复："+t.userInfo.username,this.focus=!0;var o=t.pid;this.form.pid=0===o?t.id:t.pid,this.form.to_uid=t.userInfo.uid,this.form.post_id=this.postId},onBlur:function(){this.placeholder="说点什么...",this.focus=!1,this.pid=0},getCommentList:function(){var t=this;this.loadStatus="loading",this.$H.get("comment/list",{post_id:this.postId,page:this.page}).then((function(o){200==o.code&&(t.commentList=t.commentList.concat(o.result.data),o.result.current_page===o.result.last_page||0===o.result.last_page?t.loadStatus="nomore":t.loadStatus="loadmore")}))},cancelCollection:function(){var t=this;this.$H.post("post/cancelCollection",{id:this.postId}).then((function(o){200===o.code&&(t.postDetail.collection_count--,t.postDetail.is_collection=!1)}))},addCollection:function(){var t=this;this.$H.post("post/addCollection",{id:this.postId,uid:this.postDetail.uid}).then((function(o){200===o.code&&(t.postDetail.collection_count++,t.postDetail.is_collection=!0)}))},addComment:function(){var o=this;if(this.isSubmitD=!0,""==this.form.content)return this.$u.toast("评论不能为空"),void(this.isSubmitD=!1);t.showLoading({mask:!0,title:"发布中"}),this.$H.post("post/addComment",this.form).then((function(e){200==e.code&&(o.form.content="",o.$u.toast("评论成功"),o.page=1,o.commentList=[],o.getCommentList()),o.isSubmitD=!1,t.hideLoading()}))},getPostDetail:function(){var t=this;this.$H.get("post/detail",{id:this.postId}).then((function(o){t.postDetail=o.result}))},down:function(){var o=this;this.$H.post("post/checkint",{post_id:this.postId}).then((function(e){o.$u.toast(""),200==e.code?t.downloadFile({url:o.postDetail.media[0],success:function(o){200===o.statusCode&&t.saveImageToPhotosAlbum({filePath:o.tempFilePath,success:function(){t.hideLoading(),t.showToast({title:"保存成功",icon:"none"})},fail:function(){t.hideLoading(),t.showToast({title:"保存失败，请稍后重试",icon:"none"})}})}}):(o.$u.toast(""),0==o.postDetail.integral?t.downloadFile({url:o.postDetail.media[0],success:function(o){200===o.statusCode&&t.saveImageToPhotosAlbum({filePath:o.tempFilePath,success:function(){t.hideLoading(),t.showToast({title:"保存成功",icon:"none"})},fail:function(){t.hideLoading(),t.showToast({title:"保存失败，请稍后重试",icon:"none"})}})}}):t.showModal({title:"下载将消耗一次下载次数",content:"原创作者拍摄不易，未经原创作者授权，禁止任何商业用途",success:function(e){e.confirm?o.$H.post("post/numdownimg",{post_id:o.postId}).then((function(e){console.log(e),200===e.code?t.downloadFile({url:o.postDetail.media[0],success:function(o){200===o.statusCode&&t.saveImageToPhotosAlbum({filePath:o.tempFilePath,success:function(){t.hideLoading(),t.showToast({title:"保存成功",icon:"none"})},fail:function(){t.hideLoading(),t.showToast({title:"保存失败，请稍后重试",icon:"none"})}})}}):t.showModal({title:"你的下载次数不足",content:"此内容需打赏["+o.postDetail.integral+"]音叶",success:function(e){e.confirm?o.$H.post("post/jfdownimg",{post_id:o.postId}).then((function(e){200===e.code?t.downloadFile({url:o.postDetail.media[0],success:function(o){200===o.statusCode&&t.saveImageToPhotosAlbum({filePath:o.tempFilePath,success:function(){t.hideLoading(),t.showToast({title:"保存成功",icon:"none"})},fail:function(){t.hideLoading(),t.showToast({title:"保存失败，请稍后重试",icon:"none"})}})}}):o.$u.toast("音叶不足，请充值音叶或成为会员")})):e.cancel&&console.log("用户点击取消")}})})):res.cancel&&console.log("用户点击取消")}}))}))},toUser:function(){t.navigateTo({url:"/pages/user/home?uid="+this.postDetail.uid})},onComment:function(){t.navigateTo({url:"/pages/post/comment?id="+this.postDetail.id})},onComments:function(){t.navigateTo({url:"/pages/post/comment?id="+this.postDetail.id+"&statu=1"})}},onShareAppMessage:function(t){return"button"===t.from&&console.log(t.target),this.postDetail.media.length>0&&this.postDetail.media[0],{title:this.postDetail.content,path:"/pages/post/video-detail?id="+this.postId}},onShareTimeline:function(){this.postDetail.media[0];return{title:this.postDetail.content,query:"id="+this.postId}}};o.default=e}).call(this,e("df3c")["default"])},"66f2":function(t,o,e){"use strict";e.d(o,"b",(function(){return i})),e.d(o,"c",(function(){return n})),e.d(o,"a",(function(){}));var i=function(){var t=this.$createElement,o=(this._self._c,this._f("replace")(this.postDetail.content));this.$mp.data=Object.assign({},{$root:{f0:o}})},n=[]},"7dee":function(t,o,e){"use strict";(function(t,o){var i=e("47a9");e("7882");i(e("3240"));var n=i(e("f5d0"));t.__webpack_require_UNI_MP_PLUGIN__=e,o(n.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])},"99e6":function(t,o,e){"use strict";var i=e("9b6d"),n=e.n(i);n.a},"9b6d":function(t,o,e){},ab6c:function(t,o,e){},dcc4:function(t,o,e){"use strict";var i=e("ab6c"),n=e.n(i);n.a},eef3:function(t,o,e){"use strict";e.r(o);var i=e("33f8"),n=e.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){e.d(o,t,(function(){return i[t]}))}(s);o["default"]=n.a},f5d0:function(t,o,e){"use strict";e.r(o);var i=e("66f2"),n=e("eef3");for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(o,t,(function(){return n[t]}))}(s);e("99e6"),e("dcc4");var a=e("828b"),c=Object(a["a"])(n["default"],i["b"],i["c"],!1,null,"505197a6",null,!1,i["a"],void 0);o["default"]=c.exports}},[["7dee","common/runtime","common/vendor"]]]);