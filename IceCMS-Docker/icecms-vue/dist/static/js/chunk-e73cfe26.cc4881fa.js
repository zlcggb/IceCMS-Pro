(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e73cfe26"],{"1cb0":function(t,e,o){"use strict";o.d(e,"b",(function(){return s})),o.d(e,"a",(function(){return a}));var r=o("b775");function s(t){return Object(r["a"])({url:"/ImageApi/updateimage",method:"post",data:t,dataType:"json",processData:!1,contentType:!1,timeout:6e4})}function a(t,e,o){return Object(r["a"])({url:"/ImageApi/addwatermarkimageUpload/"+e+"/"+o,method:"post",data:t,dataType:"json",processData:!1,contentType:!1,timeout:6e4})}},"5ab6":function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{"z-index":10,"class-name":"sub-navbar "+t.postForm.status}},[o("CommentDropdown",{model:{value:t.postForm.commentDisabled,callback:function(e){t.$set(t.postForm,"commentDisabled",e)},expression:"postForm.commentDisabled"}}),o("PlatformDropdown",{model:{value:t.postForm.platforms,callback:function(e){t.$set(t.postForm,"platforms",e)},expression:"postForm.platforms"}}),o("SourceUrlDropdown",{model:{value:t.postForm.source_uri,callback:function(e){t.$set(t.postForm,"source_uri",e)},expression:"postForm.source_uri"}}),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v(" 提交 ")]),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:t.draftForm}},[t._v(" 草稿 ")])],1),o("div",{staticClass:"createPost-main-container"},[o("el-row",[o("Warning"),o("el-col",{attrs:{span:24}},[o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[o("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v(" 标题 ")])],1),o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"60px",label:"作者:",prop:"author"}},[o("el-select",{attrs:{"remote-method":t.getRemoteUserList,filterable:"","default-first-option":"",remote:"",placeholder:"选择作者"},model:{value:t.postForm.author,callback:function(e){t.$set(t.postForm,"author",e)},expression:"postForm.author"}},t._l(t.userListOptions,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t,value:t}})})),1)],1)],1),o("el-col",{attrs:{span:10}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"发布时间:"}},[o("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期和时间"},model:{value:t.displayTime,callback:function(e){t.displayTime=e},expression:"displayTime"}})],1)],1),o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"90px",label:"重要性:"}},[o("el-rate",{staticStyle:{display:"inline-block"},attrs:{max:3,colors:["#99A9BF","#F7BA2A","#FF9900"],"low-threshold":1,"high-threshold":3},model:{value:t.postForm.ownerTag,callback:function(e){t.$set(t.postForm,"ownerTag",e)},expression:"postForm.ownerTag"}})],1)],1)],1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("div",{staticClass:"postInfo-container"},[o("el-row",[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{"label-width":"60px",label:"简介:"}},[o("el-input",{staticClass:"article-textarea",attrs:{rows:1,type:"textarea",autosize:"",placeholder:"简单介绍一下吧"},model:{value:t.postForm.intro,callback:function(e){t.$set(t.postForm,"intro",e)},expression:"postForm.intro"}}),o("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"words")])],1)],1)],1)],1)])],1),o("el-row",[o("el-col",{attrs:{span:6}},[o("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"60px",label:"分类:",prop:"class"}},[o("el-select",{attrs:{"remote-method":t.getRemoteUserList,filterable:"","default-first-option":"",remote:"",placeholder:"选择分类"},model:{value:t.postForm.sortClass,callback:function(e){t.$set(t.postForm,"sortClass",e)},expression:"postForm.sortClass"}},t._l(t.ClassListOptions,(function(t,e){return o("el-option",{key:t+e,attrs:{label:t,value:t}})})),1)],1)],1),o("el-col",{attrs:{span:3}},[o("el-form-item",{attrs:{"label-width":"60px",label:"标签:"}},[o("el-drag-select",{staticStyle:{width:"400px"},attrs:{multiple:"",placeholder:"请选择"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,(function(t){return o("el-option",{key:t.id,attrs:{label:t.tagName,value:t.id}})})),1)],1)],1)],1),o("el-row",[o("el-col",{attrs:{span:24}},[o("div",{staticClass:"postInfo-container",staticStyle:{"margin-left":"16px"}},[o("el-row",[o("el-col",{attrs:{span:3}},[o("div",[o("p",[t._v("是否付费")]),o("el-switch",{attrs:{"active-text":"付费","inactive-text":"免费"},model:{value:t.isfree,callback:function(e){t.isfree=e},expression:"isfree"}})],1)]),o("el-col",{attrs:{span:5}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.isfree,expression:"isfree"}],staticStyle:{"margin-left":"18px"}},[o("p",[t._v("设置价格")]),o("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"请输入价格"},model:{value:t.postForm.price,callback:function(e){t.$set(t.postForm,"price",e)},expression:"postForm.price"}}),t._v("元 ")],1)]),o("el-col",{attrs:{span:10}},[o("div",{staticStyle:{"margin-left":"18px"}},[o("p",[t._v("资源链接")]),o("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入链接"},model:{value:t.postForm.resAddress,callback:function(e){t.$set(t.postForm,"resAddress",e)},expression:"postForm.resAddress"}})],1)]),o("el-col",{attrs:{span:6}},[o("p",[t._v("资源密码")]),o("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入密码"},model:{value:t.postForm.resPassword,callback:function(e){t.$set(t.postForm,"resPassword",e)},expression:"postForm.resPassword"}})],1)],1)],1)])],1),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"content"}},[o("Tinymce",{ref:"editor",attrs:{height:400},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),o("el-form-item",{staticStyle:{"margin-bottom":"30px"},attrs:{prop:"image_uri"}},[o("Upload",{attrs:{foriscreate:!1,fortitle:this.postForm.title,forcontent:this.postForm.intro},model:{value:t.postForm.thumb,callback:function(e){t.$set(t.postForm,"thumb",e)},expression:"postForm.thumb"}})],1),o("h4",[t._v("上传轮播图")]),o("div",{staticClass:"upload-container"},[o("el-upload",{staticClass:"upload-demo",attrs:{action:"","on-preview":t.handlePreview,"on-remove":t.handleRemove,"file-list":t.fileList,"before-upload":t.BeforeUpload,"http-request":t.Upload,"list-type":"picture-card"}},[o("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),o("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过2mb")])],1)],1)],1)],1)],1)},s=[],a=o("1da1"),n=(o("96cf"),o("b0c0"),o("e9c4"),o("d81d"),o("d3b7"),o("25f0"),o("61f7")),i=o("c466"),l=o("2c65"),c=o("680f"),u=o("b804"),p=o("96af"),m=o("f393"),d=o("6c6e"),f=o("c24f"),h=o("1cb0"),g=o("a495"),b=o("8256"),v=o("1aba"),w={status:"draft",title:"",content:"",intro:"",source_uri:"",createTime:void 0,id:void 0,platforms:["a-platform"],commentDisabled:!1,ownerTag:0},F={name:"ResourceDetail",components:{ElDragSelect:l["a"],Tinymce:b["a"],MDinput:v["a"],Upload:c["a"],Sticky:u["a"],Warning:p["a"],CommentDropdown:m["a"],PlatformDropdown:m["b"],SourceUrlDropdown:m["c"]},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,o,r){""===o?(t.$message({message:e.field+"为必传项",type:"error"}),r(new Error(e.field+"为必传项"))):r()},o=function(e,o,r){""===t.postForm.author||void 0===t.postForm.author||null===t.postForm.author?(t.$message({message:e.field+"为必传项",type:"error"}),r(new Error(e.field+"为必填字段"))):r()},r=function(e,o,r){o?Object(n["c"])(o)?r():(t.$message({message:"外链url填写不正确",type:"error"}),r(new Error("外链url填写不正确"))):r()};return{fileList:[],imageList:[],newFile:new FormData,isfree:!1,value:[],options:[],articleid:"",postForm:Object.assign({},w),loading:!1,userListOptions:[],ClassListOptions:[],rules:{image_uri:[{validator:e}],title:[{validator:e}],author:[{validator:o}],content:[{validator:e}],source_uri:[{validator:r,trigger:"blur"}]},tempRoute:{}}},computed:{contentShortLength:function(){return this.postForm.intro.length},displayTime:{get:function(){return+new Date(this.postForm.createTime)},set:function(t){this.postForm.createTime=new Date(t),this.postForm.createTime=Object(i["b"])(this.postForm.createTime)}}},created:function(){var t=this.$route.params&&this.$route.params.id;this.getRemoteUserList(),this.getRemoteTagList(t),this.isEdit&&(this.articleid=this.$route.params.id,this.fetchData(t),this.fetchData(this.articleid)),this.tempRoute=Object.assign({},this.$route)},methods:{handleRemove:function(t,e){console.log(t,e)},handlePreview:function(t){console.log(t)},BeforeUpload:function(t){if(!t)return!1;this.newFile.append("file",t),console.log(this.newFile.get("file")),console.log(this.newFile.get("file"),"123")},Upload:function(){var t=this,e=this.newFile.get("file");console.log(this.newFile),console.log(e,"564");var o=new FormData;o.append("editormd-image-file",e,e.name),Object(h["b"])(o).then((function(e){t.$message({message:"上传成功",type:"success",showClose:!0,duration:1e3}),t.newFile=new FormData;var o=e.data.url;t.tempUrl=o;var r={url:t.tempUrl,name:t.tempUrl};t.imageList.push(r),t.fileList.push(r)})).catch((function(e){t.$message.error("抱歉,上传失败"),t.theprogress=!1,console.log("上传失败")}))},fetchData:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:Object(d["h"])(t).then((function(t){console.log(t),e.postForm=t.data,e.postForm.price=t.data.price/100,e.postForm.articleStatus=t.data.articleStatus,Object(d["g"])(t.data.sortClass).then((function(t){e.postForm.sortClass=t.data})),e.setTagsViewTitle(),e.setPageTitle()})).catch((function(t){console.log(t)}));case 1:case"end":return o.stop()}}),o)})))()},setTagsViewTitle:function(){var t="编辑资源",e=Object.assign({},this.tempRoute,{title:"".concat(t,"-").concat(this.postForm.id)});this.$store.dispatch("tagsView/updateVisitedView",e)},setPageTitle:function(){var t="编辑资源";document.title="".concat(t," - ").concat(this.postForm.id)},submitForm:function(){var t=this,e=this;this.postForm.keyword=JSON.stringify(this.value),this.$refs.postForm.validate((function(o){if(!o)return t.loading=!1,console.log("error submit!!"),!1;t.loading=!0,t.postForm.status="published";var r=JSON.stringify(t.imageList);e.postForm.carousel=r,e.postForm.isFree=t.isfree,e.postForm.price=100*t.postForm.price,Object(d["d"])(e.postForm).then((function(o){200===o.status?(e.postForm.price=t.postForm.price/100,t.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3}),t.postForm.id=o.data,t.postForm.status="published",t.loading=!1):(e.postForm.price=t.postForm.price/100,console.log("保存失败"))})).catch((function(o){return e.postForm.price=t.postForm.price/100,console.log("error submit!!"),t.postForm.status="draft",t.loading=!1,t.$notify.error({title:"失败",message:"请检查网络连接"}),!1}))}))},draftForm:function(){var t=this;if(0!==this.postForm.content.length&&0!==this.postForm.title.length){var e=this;this.loading=!0,this.postForm.status="draft",createArticle(e.postForm).then((function(e){200===e.status?(t.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3}),t.postForm.status="draft",t.loading=!1):(console.log("保存失败"),t.loading=!1)})).catch((function(e){return console.log("error submit!!"),t.loading=!1,!1}))}else this.$message({message:"请填写必要的标题和内容",type:"warning"})},getRemoteTagList:function(t){var e=this;Object(g["a"])(t).then((function(t){e.options=t.data}))},getRemoteUserList:function(t){var e=this;Object(f["g"])().then((function(t){e.userListOptions=t.data.map((function(t){return[t.username].toString()}))})),Object(d["e"])().then((function(t){e.ClassListOptions=t.data.map((function(t){return[t.name].toString()}))}))}}},y=F,x=(o("8248"),o("2877")),_=Object(x["a"])(y,r,s,!1,null,"5fd09cc5",null);e["a"]=_.exports},"6c6e":function(t,e,o){"use strict";o.d(e,"d",(function(){return s})),o.d(e,"f",(function(){return a})),o.d(e,"a",(function(){return n})),o.d(e,"h",(function(){return i})),o.d(e,"i",(function(){return l})),o.d(e,"c",(function(){return c})),o.d(e,"b",(function(){return u})),o.d(e,"g",(function(){return p})),o.d(e,"e",(function(){return m}));var r=o("b775");function s(t){return Object(r["a"])({url:"/resource/create",method:"post",data:t,dataType:"json",crossDomain:!0,processData:!1,contentType:!1})}function a(t){return Object(r["a"])({url:"resource/getAllResource/"+t.page+"/"+t.limit,method:"get"})}function n(t){return Object(r["a"])({url:"resource/DelectResourceById/"+t,method:"get"})}function i(t){return Object(r["a"])({url:"resource/getResourceById/"+t,method:"get"})}function l(t){return Object(r["a"])({url:"/ResourceClass/newResourceClass",method:"post",data:t,dataType:"json",crossDomain:!0,processData:!1,contentType:!1})}function c(t){return Object(r["a"])({url:"ResourceClass/allResourceClass/"+t.page+"/"+t.limit,method:"post"})}function u(t){return Object(r["a"])({url:"ResourceClass/DeleteResourceClass/"+t,method:"get"})}function p(t){return Object(r["a"])({url:"ResourceClass/getClassNameById/"+t,method:"get"})}function m(t){return Object(r["a"])({url:"ResourceClass/getAllClassName",method:"get",data:t})}},8248:function(t,e,o){"use strict";o("a961")},"96af":function(t,e,o){"use strict";var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("aside")},s=[],a=o("2877"),n={},i=Object(a["a"])(n,r,s,!1,null,null,null);e["a"]=i.exports},a495:function(t,e,o){"use strict";o.d(e,"a",(function(){return s}));var r=o("b775");function s(){return Object(r["a"])({url:"Tag/getAllTag",method:"get"})}},a961:function(t,e,o){},c24f:function(t,e,o){"use strict";o.d(e,"g",(function(){return s})),o.d(e,"h",(function(){return a})),o.d(e,"e",(function(){return n})),o.d(e,"b",(function(){return i})),o.d(e,"a",(function(){return l})),o.d(e,"d",(function(){return c})),o.d(e,"f",(function(){return u})),o.d(e,"c",(function(){return p}));var r=o("b775");function s(){return Object(r["a"])({url:"/UserRole/getAllUserName",method:"get"})}function a(){return Object(r["a"])({url:"/UserRole/getAllUserRole",method:"get"})}function n(t){return Object(r["a"])({url:"/User/GetUserInfoByid/"+t,method:"get"})}function i(t,e){return Object(r["a"])({url:"/User/ChangeUser/"+t,method:"post",data:e})}function l(t,e,o,s){return Object(r["a"])({url:"/User/ChangePassword/"+t+"/"+e+"/"+o+"/"+s,method:"post"})}function c(t,e,o){return Object(r["a"])({url:"/User/CreateVip/"+t+"/"+e+"/"+o,method:"get"})}function u(t,e,o){return Object(r["a"])({url:"/User/UpdateIntegral/"+t+"/"+e+"/"+o,method:"get"})}function p(t){return Object(r["a"])({url:"/User/CheckVip/"+t,method:"get"})}},c466:function(t,e,o){"use strict";o.d(e,"c",(function(){return r})),o.d(e,"b",(function(){return a})),o.d(e,"a",(function(){return n}));o("ac1f"),o("00b4"),o("5319"),o("4d63"),o("2c3e"),o("25f0"),o("1276");function r(t,e){/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));var o={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds()};for(var r in o)if(new RegExp("(".concat(r,")")).test(e)){var a=o[r]+"";e=e.replace(RegExp.$1,1===RegExp.$1.length?a:s(a))}return e}function s(t){return("00"+t).substr(t.length)}function a(t){t+="";var e="",o=new Array;o["Jan"]=1,o["Feb"]=2,o["Mar"]=3,o["Apr"]=4,o["May"]=5,o["Jan"]=6,o["Jul"]=7,o["Aug"]=8,o["Sep"]=9,o["Oct"]=10,o["Nov"]=11,o["Dec"]=12;var r=new Array;r["Mon"]="一",r["Tue"]="二",r["Wed"]="三",r["Thu"]="四",r["Fri"]="五",r["Sat"]="六",r["Sun"]="日";var s=t.split(" ");return e=s[3]+"-",e=e+o[s[1]]+"-"+s[2]+" "+s[4],e}function n(t){var e=t,o=new Date(e);return o.getDay(),o.getDay()}},f393:function(t,e,o){"use strict";o.d(e,"a",(function(){return c})),o.d(e,"b",(function(){return h})),o.d(e,"c",(function(){return y}));var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v(" "+t._s(t.commentDisabled?"评论: 关闭":"评论: 开启")+" "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),o("el-dropdown-menu",{staticClass:"no-padding",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",[o("el-radio-group",{staticStyle:{padding:"10px"},model:{value:t.commentDisabled,callback:function(e){t.commentDisabled=e},expression:"commentDisabled"}},[o("el-radio",{attrs:{label:!0}},[t._v(" 关闭评论 ")]),o("el-radio",{attrs:{label:!1}},[t._v(" 开启评论 ")])],1)],1)],1)],1)},s=[],a={props:{value:{type:Boolean,default:!1}},computed:{commentDisabled:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},n=a,i=o("2877"),l=Object(i["a"])(n,r,s,!1,null,null,null),c=l.exports,u=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"hide-on-click":!1,"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v(" 平台("+t._s(t.platforms.length)+") "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),o("el-dropdown-menu",{staticClass:"no-border",attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-checkbox-group",{staticStyle:{padding:"5px 15px"},model:{value:t.platforms,callback:function(e){t.platforms=e},expression:"platforms"}},t._l(t.platformsOptions,(function(e){return o("el-checkbox",{key:e.key,attrs:{label:e.key}},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)},p=[],m={props:{value:{required:!0,default:function(){return[]},type:Array}},data:function(){return{platformsOptions:[{key:"a-platform",name:"PC"},{key:"b-platform",name:"h5"},{key:"c-platform",name:"移动"}]}},computed:{platforms:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},d=m,f=Object(i["a"])(d,u,p,!1,null,null,null),h=f.exports,g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-dropdown",{attrs:{"show-timeout":100,trigger:"click"}},[o("el-button",{attrs:{plain:""}},[t._v(" Link "),o("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),o("el-dropdown-menu",{staticClass:"no-padding no-border",staticStyle:{width:"400px"},attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{"label-width":"0px",prop:"source_uri"}},[o("el-input",{attrs:{placeholder:"请输入链接"},model:{value:t.source_uri,callback:function(e){t.source_uri=e},expression:"source_uri"}},[o("template",{slot:"prepend"},[t._v(" URL ")])],2)],1)],1)],1)},b=[],v={props:{value:{type:String,default:""}},computed:{source_uri:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}}},w=v,F=Object(i["a"])(w,g,b,!1,null,null,null),y=F.exports}}]);